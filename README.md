# inDAGO
![favicon-96x96](https://github.com/user-attachments/assets/4d325017-c452-4e8d-95a7-12f1f7ccd6f7)

A Shiny app for dual and bulk RNA‚Äësequencing analysis

## üëÄ Overview

**inDAGO** supports both **dual** and **bulk RNA-seq** workflows within a single, user-friendly Shiny interface.  

For **dual RNA-seq**, users can choose between two alignment strategies:

- **Sequential mapping** ‚Äî reads are mapped separately to each reference genome  
- **Combined mapping** ‚Äî reads are aligned once to a merged reference genome  

<details>
  <summary><strong>üìä See dual RNA-seq workflow</strong> ‚ñ∏</summary>

  <br>

<img src="https://github.com/user-attachments/assets/f2bd0532-af8e-4f5c-810f-aebfa071b2fd" width="700" alt="Dual RNA-seq workflow"/>


  <p align="justify">
  <em><strong>Figure:</strong> Overview of the inDAGO dual RNA-seq workflow.</em>  
  The workflow supports both sequential and combined mapping approaches and consists of seven steps. Steps 1, 2, 5, 6, and 7 are common to both approaches, whereas Steps 3 and 4 differ.  
  <br><br>
  <strong>Step 1:</strong> Quality control of raw mixed reads (organism A + organism B, FASTQ format) using the <code>Biostrings</code> and <code>ShortRead</code> packages; visualizations are produced with <code>ggplot2</code> and custom R scripts.  
  <br>
  <strong>Step 2:</strong> Filtering of raw mixed reads using <code>Biostrings</code> and <code>ShortRead</code>.  
  <br>
  <strong>Step 3:</strong> Genome indexing of reference sequences (FASTA) performed with <code>Rsubread</code>. In the sequential approach, each organism is indexed separately; in the combined approach, a concatenated genome is indexed once.  
  <br>
  <strong>Step 4:</strong> Alignment of filtered reads, manipulation of SAM/BAM files, and in-silico discrimination of mixed transcripts using <code>Rsubread</code>, <code>Rsamtools</code>, and base R functions. The sequential approach performs two mappings (one per organism), while the combined approach performs a single mapping followed by computational read separation.  
  <br>
  <strong>Step 5:</strong> Assignment and summarization of mapped reads for each organism using <code>Rsubread</code>.  
  <br>
  <strong>Step 6:</strong> Exploration of summarized counts through statistical and graphical analysis using <code>ggplot2</code>, <code>pheatmap</code>, <code>Hmisc</code>, and <code>RNAseQC</code>.  
  <br>
  <strong>Step 7:</strong> Identification of differentially expressed genes (DEGs) with <code>edgeR</code> and <code>HTSFilter</code>.  
  </p>

</details>

<details>
  <summary><strong>üìä See bulk RNA-seq workflow</strong> ‚ñ∏</summary>

  <br>
  
<img src="https://github.com/user-attachments/assets/6e73d380-1b5e-4279-a9dd-1eff7dd322c3" width="400" alt="Bulk RNA-seq workflow"/>


  <p align="justify">
  <em><strong>Figure:</strong> Overview of the inDAGO bulk RNA-seq workflow.</em>  
  The bulk RNA-seq workflow follows seven key steps, mirroring the dual workflow but focused on a single organism.  
  <br><br>
  <strong>Step 1:</strong> Quality control of raw reads.  
  <br>
  <strong>Step 2:</strong> Filtering of low-quality sequences.  
  <br>
  <strong>Step 3:</strong> Genome indexing of the reference genome (FASTA).  
  <br>
  <strong>Step 4:</strong> Alignment of reads to the reference.  
  <br>
  <strong>Step 5:</strong> Summarization of mapped reads by biological unit (e.g., gene).  
  <br>
  <strong>Step 6:</strong> Statistical exploration and visualization of read counts.  
  <br>
  <strong>Step 7:</strong> Identification of differentially expressed genes (DEGs).  
  <br><br>
  The bulk RNA-seq workflow uses the same core set of R packages as the dual pipeline, ensuring consistency and reproducibility across analyses.
  </p>

</details>

   
The interface walks you step‚Äëby‚Äëstep through the entire analysis, from raw reads to publication‚Äëready plots, and lets you:

- Download intermediate results at each step  
- Export high‚Äëquality figures directly for your manuscript  

Thanks to optimized, parallelized code, inDAGO runs efficiently on a standard laptop (16‚ÄØGB RAM), so you don‚Äôt need access to a high‚Äëperformance cluster.

## üîß Key Modules

1. **Quality Control**  
   Generates quality control metrics and graphical plots.

<details>
  <summary><strong>üìä See plots</strong> ‚ñ∏</summary>

  <br>

<img src="https://github.com/user-attachments/assets/d67cf139-1c9b-45c3-af46-a25f5acb484b" width="1000" alt="Quality Control Module Outputs"/>

  <p align="justify">
  <em><strong>Figure:</strong> Quality Control Module Outputs.</em>  
  This figure presents key quality control plots generated by <strong>inDAGO</strong>:  
  (A) average base quality line plot;  
  (B) sequence length distribution;  
  (C) GC content distribution across reads;  
  (D) base quality boxplot showing average and variation per base position;  
  (E) base composition line plot; and  
  (F) base composition area chart across the dataset.  
  Together, these visualizations provide a comprehensive assessment of the sequencing quality and the overall characteristics of the raw read data.
  </p>

</details>

  
3. **Sequence Pre‚Äëprocessing**  
   Read trimming, low‚Äëquality filtering, and adapter removal
4. **Genome indexing**  
   Index genome or genomes according to the selected approach (bulk or dual RNA‚Äëseq)
5. **Reference‚Äëbased Alignment**  
   Align reads according to the selected approach (bulk or dual RNA‚Äëseq) 
6. **Read Count Summarization**  
   Generate gene or transcript level count matrices  
7. **Exploratory Data Analysis**  
   PCA, MDS, heatmaps, and more.

<details>
  <summary><strong>üìä See plots</strong> ‚ñ∏</summary>

  <br>

<img src="https://github.com/user-attachments/assets/2f00b130-a2de-49c8-b8d9-887fb0cfc140" width="800" alt="Exploratory Data Analysis"/>

  <p align="justify">
  <em><strong>Figure:</strong> Exploratory Data Analysis Module Outputs.</em>  
  This figure presents key exploratory data analysis plots generated by <strong>inDAGO</strong>:  
  (A) Principal Component Analysis (PCA) plot;  
  (B) Multi-Dimensional Scaling (MDS) plot;  
  (C) gene expression boxplot;  
  (D) library size bar plot;  
  (E) gene expression heatmap;  
  (F) correlation heatmap; and  
  (G) saturation plot.  
  Together, these visualizations provide a comprehensive overview of the exploratory data analysis results and the underlying characteristics of the count data.
  </p>

</details>
   
9. **Differential Expression Genes (DEGs) analysis**  
   Identify differentially expressed genes/transcripts across comparisons

<details>
  <summary><strong>üìä See plots</strong> ‚ñ∏</summary>

  <br>

<img src="https://github.com/user-attachments/assets/a1610c8b-5c90-4dcf-ac0d-6d546372ea99" width="400" alt="Differential Expression Genes (DEGs) analysis"/>


  <p align="justify">
  <em><strong>Figure:</strong> Differential Expression Gene (DEG) Module Outputs.</em>  
  This figure presents key DEGs analysis plots generated by <strong>inDAGO</strong>:  
  (A) volcano plot; and  
  (B) UpSet plot.  
Together, these visualizations provide a comprehensive overview of the differential expression analysis results and highlight key transcriptional changes between conditions.
  </p>

</details>

<br>
<br>

<details>
  <summary><strong>üíª INSTALLATION GUIDE: R AND RSTUDIO</strong> ‚ñ∏</summary>

###  1. Install R

**Official site:** [CRAN R Project](https://cran.r-project.org/)

| OS | Command or Link |
|----|-----------------|
| **Windows** | [Download R for Windows](https://cran.r-project.org/bin/windows/base/) and run the `.exe` installer.
| **macOS** | [Download R for macOS](https://cran.r-project.org/bin/macosx/) and run the `.pkg` installer.


---

###  2. Install RStudio (Posit Desktop)

**Official site:** [Posit RStudio Desktop](https://posit.co/download/rstudio-desktop/)

| OS | Command or Link |
|----|-----------------|
| **Windows** | Download the `.exe` installer and run it. |
| **macOS** | Download the `.dmg` installer and drag RStudio into Applications.

---

###  3. Verify installation
```bash
R --version
Rscript -e 'cat(R.version.string, "\n")'
```
  
</details>
<details>
   <summary><strong>üíª INSTALLATION GUIDE: INDAGO</strong> ‚ñ∏</summary>


## How to install inDAGO from CRAN or GitHub

### Install the Bioconductor dependencies

```r

# Install Bioconductor dependencies if you don't have them yet
if (!requireNamespace("BiocManager", quietly = TRUE))
  install.packages("BiocManager")
bioc_pac <- c(
  "XVector",
  "ShortRead",
  "S4Vectors",
  "rtracklayer",
  "Rsubread",
  "Rsamtools",
  "Rfastp",
  "limma",
  "HTSFilter",
  "edgeR",
  "Biostrings",
  "BiocGenerics"
) 
for (pac in bioc_pac) {
  if (!requireNamespace(pac, quietly = TRUE))
    BiocManager::install(pac)
}

```

### Install inDAGO from GitHub

```r
#Install devtools if you don‚Äôt have it yet
if (!requireNamespace("devtools", quietly = TRUE))
  install.packages("devtools")

# Install inDAGO
devtools::install_github("inDAGOverse/inDAGO")

```

### Install inDAGO from CRAN (https://cran.r-project.org/web/packages/inDAGO/index.html)

```r

# Install inDAGO
install.packages("inDAGO")

```
</details>
<details>
   <summary><strong>üöÄ HOW TO LOAD AND LAUNCH THE APP</strong> ‚ñ∏</summary>

```r
# Load and launch the app
library(inDAGO)
inDAGO::inDAGO()

```
</details>
<details>
   <summary><strong>‚öôÔ∏è TIPS FOR A SEAMLESS EXECUTION</strong> ‚ñ∏</summary>
   
To ensure execution during long time-consuming steps such as reference‚Äëbased alignment:

üí§ Disable sleep mode to keep your system active.

üí° Reduce screen brightness to save power.

These simple precautions can help avoid incomplete runs and unnecessary power consumption.

</details>
<details>
   <summary><strong>üë• AUTHORS & ACKNOWLEDGEMENTS</strong> ‚ñ∏</summary>

- **Authors / Creators**  
  - Carmine Fruggiero (c.fruggiero@tigem.it)  
  - Gaetano Aufiero (gaetano.aufiero@unina.it)

- **Designated maintainer for CRAN Repository**  
  - Carmine Fruggiero (c.fruggiero@tigem.it)

- **Project Supervisor**  
  - Nunzio D'Agostino (nunzio.dagostino@unina.it)
</details>
